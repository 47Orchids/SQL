/* Top 10 Best-Selling Artists of All Time (2022), Source: https://ledgernote.com/blog/interesting/best-selling-artists-of-all-time/ */
CREATE TABLE artists
    (id INTEGER PRIMARY KEY AUTOINCREMENT, 
    name TEXT,
    nationality TEXT,
    birthdate TEXT);
    
INSERT INTO artists (name, nationality, birthdate) VALUES ("The Beatles", "UK", "NA");
INSERT INTO artists (name, nationality, birthdate) VALUES ("Elvis Presley", "USA", "Jan 08, 1977");
INSERT INTO artists (name, nationality, birthdate) VALUES ("Michael Jackson", "USA", "Aug 29, 1958");
INSERT INTO artists (name, nationality, birthdate) VALUES ("Drake", "Canada/USA", "Oct 24, 1986");
INSERT INTO artists (name, nationality, birthdate) VALUES ("Rihanna", "Barbados/USA", "Feb 20, 1988");
INSERT INTO artists (name, nationality, birthdate) VALUES ("Eminem", "USA", "Oct 17, 1972");
INSERT INTO artists (name, nationality, birthdate) VALUES ("Elton John", "UK", "Mar 25, 1947");
INSERT INTO artists (name, nationality, birthdate) VALUES ("Madonna", "USA", "Aug 16, 1958");
INSERT INTO artists (name, nationality, birthdate) VALUES ("Led Zeppelin", "UK", "NA");
INSERT INTO artists (name, nationality, birthdate) VALUES ("Justin Bieber", "Canada", "Mar 01, 1994");


CREATE TABLE sales
    (id INTEGER PRIMARY KEY AUTOINCREMENT,
    artist_name TEXT,
    total INTEGER);
    
INSERT INTO sales (artist_name, total)
VALUES ("The Beatles", 600000000);
INSERT INTO sales (artist_name, total)
VALUES ("Elvis Presley", 500000000);
INSERT INTO sales (artist_name, total)
VALUES ("Michael Jackson", 400000000);
INSERT INTO sales (artist_name, total)
VALUES ("Drake", 395200000);
INSERT INTO sales (artist_name, total)
VALUES ("Rihanna", 328500000);
INSERT INTO sales (artist_name, total)
VALUES ("Eminem", 321400000);
INSERT INTO sales (artist_name, total)
VALUES ("Elton John", 300000000);
INSERT INTO sales (artist_name, total)
VALUES ("Madonna", 300000000);
INSERT INTO sales (artist_name, total)
VALUES ("Led Zeppelin", 300000000);
INSERT INTO sales (artist_name, total)
VALUES ("Justin Bieber", 261400000);


--Show artists' rank by sales and show nationality
SELECT artists.name, artists.nationality, sales.total FROM artists
    JOIN sales ON artists.name = artist_name
    ORDER BY total DESC;
    
--How many artists on the list are British and how much did those artists bring in total sales?
SELECT artists.nationality, SUM(sales.total) AS total_sales
    FROM artists
    JOIN sales ON artists.name = artist_name
    GROUP BY nationality
    HAVING nationality = "UK";
    
--Avergage total in sales generated by top 10 artists
SELECT AVG(total) AS average_sales FROM sales;
    
--Which of the top 10 listed were groups instead of solo artists?
SELECT name AS "group", nationality FROM artists
    WHERE birthdate = "NA";
